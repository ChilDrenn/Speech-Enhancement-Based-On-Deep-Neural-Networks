Starting training:
without SE:
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.01], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.4683098793029785, Discriminator loss: 0.32857716509274076
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.1268,SSNR: -0.2065,CSIG: 2.1627,CBAK: 1.9103,COVL: 1.6103,STOI: 0.7089,
INFO:root:Generator loss: 0.3386275427682059, Discriminator loss: 0.347371620791299
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.8689,SSNR: 2.9835,CSIG: 3.1676,CBAK: 2.5983,COVL: 2.5327,STOI: 0.8630,
INFO:root:Generator loss: 0.30453300901821684, Discriminator loss: 0.21052880798067367
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.9425,SSNR: 3.4747,CSIG: 3.2555,CBAK: 2.6703,COVL: 2.6157,STOI: 0.8709,
INFO:root:Generator loss: 0.2772827616759709, Discriminator loss: 0.11957100246633802
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2441,SSNR: 3.4692,CSIG: 3.6395,CBAK: 2.8337,COVL: 2.9661,STOI: 0.8949,
INFO:root:Generator loss: 0.26258997193404604, Discriminator loss: 0.08180745637842587
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2181,SSNR: 4.3553,CSIG: 3.6691,CBAK: 2.8726,COVL: 2.9661,STOI: 0.8993,
INFO:root:Generator loss: 0.254889930997576, Discriminator loss: 0.043455179780721664
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2266,SSNR: 4.4717,CSIG: 3.6446,CBAK: 2.8869,COVL: 2.9592,STOI: 0.9025,
INFO:root:Generator loss: 0.2397490782397134, Discriminator loss: 0.03472089142139469
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2775,SSNR: 4.9029,CSIG: 3.6623,CBAK: 2.9404,COVL: 2.9945,STOI: 0.9070,
INFO:root:Generator loss: 0.25421059131622314, Discriminator loss: 0.017918308531599387
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3364,SSNR: 4.5564,CSIG: 3.6786,CBAK: 2.9444,COVL: 3.0315,STOI: 0.9106,
INFO:root:Generator loss: 0.2378199781690325, Discriminator loss: 0.030342310267899717
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3046,SSNR: 5.0620,CSIG: 3.7115,CBAK: 2.9667,COVL: 3.0339,STOI: 0.9124,
INFO:root:Generator loss: 0.2297659111874444, Discriminator loss: 0.0362598965210574
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3134,SSNR: 4.7294,CSIG: 3.7457,CBAK: 2.9502,COVL: 3.0554,STOI: 0.9127,
INFO:root:Generator loss: 0.23379489140851156, Discriminator loss: 0.028070179346416677
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3874,SSNR: 5.5451,CSIG: 3.7843,CBAK: 3.0366,COVL: 3.1118,STOI: 0.9129,
INFO:root:Generator loss: 0.22059130242892674, Discriminator loss: 0.017238156736961434
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3495,SSNR: 5.6204,CSIG: 3.7845,CBAK: 3.0237,COVL: 3.0930,STOI: 0.9146,
INFO:root:Generator loss: 0.2222794315644673, Discriminator loss: 0.011464422302586692
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3350,SSNR: 5.7096,CSIG: 3.7723,CBAK: 3.0232,COVL: 3.0799,STOI: 0.9161,
INFO:root:Generator loss: 0.21616351178714208, Discriminator loss: 0.0053304444632626
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3639,SSNR: 5.7587,CSIG: 3.7965,CBAK: 3.0412,COVL: 3.1069,STOI: 0.9165,
INFO:root:Generator loss: 0.2159170401947839, Discriminator loss: 0.008457263399447714
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3792,SSNR: 5.9349,CSIG: 3.8109,CBAK: 3.0602,COVL: 3.1221,STOI: 0.9177,
INFO:root:Generator loss: 0.21935998967715672, Discriminator loss: 0.00997564718792481
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3721,SSNR: 5.8519,CSIG: 3.8123,CBAK: 3.0530,COVL: 3.1196,STOI: 0.9188,
INFO:root:Generator loss: 0.2120196670293808, Discriminator loss: 0.008749770166884576
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4188,SSNR: 6.0701,CSIG: 3.8390,CBAK: 3.0891,COVL: 3.1565,STOI: 0.9189,
INFO:root:Generator loss: 0.21201777245317185, Discriminator loss: 0.014269938160266196
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3737,SSNR: 6.0578,CSIG: 3.7948,CBAK: 3.0687,COVL: 3.1125,STOI: 0.9178,
INFO:root:Generator loss: 0.20684133682932174, Discriminator loss: 0.005369215372151562
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3839,SSNR: 6.1558,CSIG: 3.8298,CBAK: 3.0787,COVL: 3.1346,STOI: 0.9200,
INFO:root:Generator loss: 0.20766375958919525, Discriminator loss: 0.0071604374263967785
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4154,SSNR: 5.9584,CSIG: 3.8495,CBAK: 3.0802,COVL: 3.1599,STOI: 0.9205,
INFO:root:Generator loss: 0.20476227785859788, Discriminator loss: 0.0241399457944291
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3859,SSNR: 5.8897,CSIG: 3.8153,CBAK: 3.0648,COVL: 3.1291,STOI: 0.9193,
INFO:root:Generator loss: 0.21025963766234262, Discriminator loss: 0.021428818548364297
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4240,SSNR: 6.2364,CSIG: 3.8610,CBAK: 3.1044,COVL: 3.1709,STOI: 0.9215,
INFO:root:Generator loss: 0.19883573268141067, Discriminator loss: 0.0137359828222543
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4179,SSNR: 6.3526,CSIG: 3.8493,CBAK: 3.1099,COVL: 3.1624,STOI: 0.9210,
INFO:root:Generator loss: 0.20091277360916138, Discriminator loss: 0.018308266731245176
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4303,SSNR: 6.3591,CSIG: 3.8566,CBAK: 3.1154,COVL: 3.1720,STOI: 0.9212,
INFO:root:Generator loss: 0.2006006176982607, Discriminator loss: 0.01251239565733288
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3942,SSNR: 6.3490,CSIG: 3.8208,CBAK: 3.0984,COVL: 3.1363,STOI: 0.9204,
INFO:root:Generator loss: 0.1972615612404687, Discriminator loss: 0.0059089284124118945
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4022,SSNR: 6.5111,CSIG: 3.8366,CBAK: 3.1126,COVL: 3.1482,STOI: 0.9222,
INFO:root:Generator loss: 0.19710651252950942, Discriminator loss: 0.006862100878996509
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4173,SSNR: 6.5216,CSIG: 3.8488,CBAK: 3.1204,COVL: 3.1619,STOI: 0.9220,
INFO:root:Generator loss: 0.19746542615549906, Discriminator loss: 0.0036241987919700997
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4163,SSNR: 6.5115,CSIG: 3.8497,CBAK: 3.1188,COVL: 3.1617,STOI: 0.9214,
INFO:root:Generator loss: 0.19795969128608704, Discriminator loss: 0.008013106317126326
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4013,SSNR: 6.3839,CSIG: 3.8378,CBAK: 3.1044,COVL: 3.1485,STOI: 0.9220,
INFO:root:Generator loss: 0.19557685937200273, Discriminator loss: 0.005645374484759357
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4373,SSNR: 6.4546,CSIG: 3.8722,CBAK: 3.1241,COVL: 3.1831,STOI: 0.9226,
Training finished.
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.02], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.3694228742803846, Discriminator loss: 0.3801270978791373
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.4522,SSNR: 1.6963,CSIG: 3.0720,CBAK: 2.2989,COVL: 2.2679,STOI: 0.8478,
INFO:root:Generator loss: 0.2939640283584595, Discriminator loss: 0.1593969932624272
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.9588,SSNR: 3.8560,CSIG: 3.4423,CBAK: 2.7180,COVL: 2.7226,STOI: 0.8906,
INFO:root:Generator loss: 0.2658541330269405, Discriminator loss: 0.12837399861642293
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.0064,SSNR: 4.1349,CSIG: 3.5069,CBAK: 2.7699,COVL: 2.7830,STOI: 0.9087,
INFO:root:Generator loss: 0.22173374465533666, Discriminator loss: 0.11621164956263133
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2747,SSNR: 5.2439,CSIG: 3.7454,CBAK: 2.9645,COVL: 3.0359,STOI: 0.9104,
INFO:root:Generator loss: 0.1967861098902566, Discriminator loss: 0.1914688923529216
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2799,SSNR: 6.3324,CSIG: 3.7282,CBAK: 3.0422,COVL: 3.0323,STOI: 0.9197,
INFO:root:Generator loss: 0.19358558527060918, Discriminator loss: 0.02343055738934449
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3637,SSNR: 7.0253,CSIG: 3.8226,CBAK: 3.1309,COVL: 3.1262,STOI: 0.9239,
INFO:root:Generator loss: 0.19969531893730164, Discriminator loss: 0.01975391379424504
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4832,SSNR: 5.1321,CSIG: 3.8988,CBAK: 3.0701,COVL: 3.2287,STOI: 0.9254,
INFO:root:Generator loss: 0.17297995941979544, Discriminator loss: 0.022924508965973343
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4814,SSNR: 7.2118,CSIG: 3.9051,CBAK: 3.2013,COVL: 3.2268,STOI: 0.9245,
INFO:root:Generator loss: 0.18527292566640036, Discriminator loss: 0.01959047278588904
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5099,SSNR: 7.1749,CSIG: 3.9479,CBAK: 3.2124,COVL: 3.2688,STOI: 0.9283,
INFO:root:Generator loss: 0.15761867378439223, Discriminator loss: 0.040870869532227516
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5616,SSNR: 7.8047,CSIG: 3.9620,CBAK: 3.2764,COVL: 3.2992,STOI: 0.9278,
INFO:root:Generator loss: 0.16686138297830308, Discriminator loss: 0.01510948222130537
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5341,SSNR: 8.0199,CSIG: 3.9444,CBAK: 3.2781,COVL: 3.2805,STOI: 0.9297,
INFO:root:Generator loss: 0.16012095766408102, Discriminator loss: 0.017517866101115942
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5886,SSNR: 8.2716,CSIG: 3.9979,CBAK: 3.3188,COVL: 3.3366,STOI: 0.9297,
INFO:root:Generator loss: 0.15371292510202952, Discriminator loss: 0.013088769745081663
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6130,SSNR: 8.2390,CSIG: 4.0119,CBAK: 3.3304,COVL: 3.3573,STOI: 0.9300,
INFO:root:Generator loss: 0.1535944544843265, Discriminator loss: 0.009194916779441493
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5802,SSNR: 8.3103,CSIG: 3.9975,CBAK: 3.3190,COVL: 3.3351,STOI: 0.9312,
INFO:root:Generator loss: 0.1544498290334429, Discriminator loss: 0.01114747506965484
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5568,SSNR: 8.3402,CSIG: 3.9789,CBAK: 3.3099,COVL: 3.3140,STOI: 0.9321,
INFO:root:Generator loss: 0.14973202028444835, Discriminator loss: 0.006945447264505284
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5910,SSNR: 8.6137,CSIG: 4.0074,CBAK: 3.3440,COVL: 3.3474,STOI: 0.9318,
INFO:root:Generator loss: 0.15168330818414688, Discriminator loss: 0.009065443450318915
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5944,SSNR: 8.6723,CSIG: 4.0082,CBAK: 3.3502,COVL: 3.3498,STOI: 0.9318,
INFO:root:Generator loss: 0.1453538558312825, Discriminator loss: 0.02314976922103337
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6266,SSNR: 8.7560,CSIG: 4.0249,CBAK: 3.3714,COVL: 3.3737,STOI: 0.9312,
INFO:root:Generator loss: 0.15335204984460557, Discriminator loss: 0.018285530685846294
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6234,SSNR: 7.7482,CSIG: 4.0326,CBAK: 3.3056,COVL: 3.3768,STOI: 0.9320,
INFO:root:Generator loss: 0.142288615661008, Discriminator loss: 0.027192426047154834
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6009,SSNR: 8.4970,CSIG: 4.0128,CBAK: 3.3452,COVL: 3.3551,STOI: 0.9325,
INFO:root:Generator loss: 0.1445012486406735, Discriminator loss: 0.014383698081863778
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5935,SSNR: 8.8541,CSIG: 4.0233,CBAK: 3.3632,COVL: 3.3573,STOI: 0.9332,
INFO:root:Generator loss: 0.14463416061231069, Discriminator loss: 0.011795102884726865
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5983,SSNR: 8.6249,CSIG: 4.0194,CBAK: 3.3518,COVL: 3.3575,STOI: 0.9324,
INFO:root:Generator loss: 0.1412635243364743, Discriminator loss: 0.011905510677024722
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6303,SSNR: 8.6391,CSIG: 4.0502,CBAK: 3.3704,COVL: 3.3912,STOI: 0.9329,
INFO:root:Generator loss: 0.14195870288780757, Discriminator loss: 0.009135538479313254
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5998,SSNR: 8.4204,CSIG: 4.0377,CBAK: 3.3403,COVL: 3.3692,STOI: 0.9337,
INFO:root:Generator loss: 0.14036189764738083, Discriminator loss: 0.009003160854003258
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5971,SSNR: 9.0462,CSIG: 4.0305,CBAK: 3.3805,COVL: 3.3634,STOI: 0.9331,
INFO:root:Generator loss: 0.1424966933471816, Discriminator loss: 0.011371051393715399
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6232,SSNR: 8.9943,CSIG: 4.0480,CBAK: 3.3896,COVL: 3.3865,STOI: 0.9326,
INFO:root:Generator loss: 0.14103051062141145, Discriminator loss: 0.005779524500082646
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6108,SSNR: 8.7306,CSIG: 4.0360,CBAK: 3.3691,COVL: 3.3733,STOI: 0.9328,
INFO:root:Generator loss: 0.13883610708372934, Discriminator loss: 0.008190530751432692
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6163,SSNR: 9.0414,CSIG: 4.0462,CBAK: 3.3891,COVL: 3.3816,STOI: 0.9331,
INFO:root:Generator loss: 0.13843471024717605, Discriminator loss: 0.009754442892569517
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5858,SSNR: 9.0939,CSIG: 4.0147,CBAK: 3.3797,COVL: 3.3490,STOI: 0.9329,
INFO:root:Generator loss: 0.13643067330121994, Discriminator loss: 0.008744920886653875
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5730,SSNR: 9.0929,CSIG: 4.0162,CBAK: 3.3722,COVL: 3.3437,STOI: 0.9337,
Training finished.
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.03], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.44876738105501446, Discriminator loss: 0.26328180730342865
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.3485,SSNR: 0.8624,CSIG: 2.5904,CBAK: 2.1746,COVL: 1.9679,STOI: 0.8338,
INFO:root:Generator loss: 0.38875773549079895, Discriminator loss: 0.3721772347177778
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.6025,SSNR: 2.4358,CSIG: 3.1365,CBAK: 2.4355,COVL: 2.3823,STOI: 0.8661,
INFO:root:Generator loss: 0.32748993379729135, Discriminator loss: 0.08573499800903457
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.9945,SSNR: 4.1625,CSIG: 3.4789,CBAK: 2.7570,COVL: 2.7598,STOI: 0.8974,
INFO:root:Generator loss: 0.315614321402141, Discriminator loss: 0.06241663598588535
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.9664,SSNR: 3.6583,CSIG: 3.4977,CBAK: 2.7147,COVL: 2.7560,STOI: 0.9057,
INFO:root:Generator loss: 0.2729096625532423, Discriminator loss: 0.033407091562237055
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.1588,SSNR: 4.8191,CSIG: 3.6407,CBAK: 2.8834,COVL: 2.9256,STOI: 0.9097,
INFO:root:Generator loss: 0.2533212623425892, Discriminator loss: 0.03399343482617821
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2213,SSNR: 5.0737,CSIG: 3.6873,CBAK: 2.9302,COVL: 2.9807,STOI: 0.9100,
INFO:root:Generator loss: 0.23405563831329346, Discriminator loss: 0.03141316398978233
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3546,SSNR: 5.7883,CSIG: 3.7819,CBAK: 3.0443,COVL: 3.0969,STOI: 0.9173,
INFO:root:Generator loss: 0.2230856716632843, Discriminator loss: 0.03114780118422849
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3865,SSNR: 6.0527,CSIG: 3.8449,CBAK: 3.0747,COVL: 3.1439,STOI: 0.9191,
INFO:root:Generator loss: 0.23444020535264695, Discriminator loss: 0.043657959438860416
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4220,SSNR: 6.1860,CSIG: 3.8028,CBAK: 3.1014,COVL: 3.1414,STOI: 0.9212,
INFO:root:Generator loss: 0.21181704316820418, Discriminator loss: 0.02251492507223572
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4238,SSNR: 6.4930,CSIG: 3.8896,CBAK: 3.1214,COVL: 3.1854,STOI: 0.9221,
INFO:root:Generator loss: 0.20892085773604258, Discriminator loss: 0.029741240133132254
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4207,SSNR: 6.5009,CSIG: 3.8673,CBAK: 3.1250,COVL: 3.1744,STOI: 0.9243,
INFO:root:Generator loss: 0.22119032910891942, Discriminator loss: 0.010292834003588982
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5061,SSNR: 5.6911,CSIG: 3.9047,CBAK: 3.1127,COVL: 3.2354,STOI: 0.9232,
INFO:root:Generator loss: 0.2096783540078572, Discriminator loss: 0.007295162716348257
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4269,SSNR: 6.5475,CSIG: 3.9028,CBAK: 3.1312,COVL: 3.1961,STOI: 0.9255,
INFO:root:Generator loss: 0.20447905148778642, Discriminator loss: 0.02173047313200576
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4548,SSNR: 6.4603,CSIG: 3.9325,CBAK: 3.1380,COVL: 3.2248,STOI: 0.9247,
INFO:root:Generator loss: 0.2083020487001964, Discriminator loss: 0.009873866502727782
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4526,SSNR: 7.0508,CSIG: 3.9008,CBAK: 3.1763,COVL: 3.2085,STOI: 0.9267,
INFO:root:Generator loss: 0.20484532415866852, Discriminator loss: 0.017883980513683388
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4745,SSNR: 6.9816,CSIG: 3.9443,CBAK: 3.1829,COVL: 3.2431,STOI: 0.9255,
INFO:root:Generator loss: 0.1963965403182166, Discriminator loss: 0.022903909906744957
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5030,SSNR: 6.9186,CSIG: 3.9491,CBAK: 3.1905,COVL: 3.2587,STOI: 0.9263,
INFO:root:Generator loss: 0.1994918010064534, Discriminator loss: 0.0141840174661151
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4744,SSNR: 7.2252,CSIG: 3.9459,CBAK: 3.1987,COVL: 3.2440,STOI: 0.9266,
INFO:root:Generator loss: 0.19303241159234727, Discriminator loss: 0.013109764217266015
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5088,SSNR: 7.2278,CSIG: 3.9712,CBAK: 3.2157,COVL: 3.2743,STOI: 0.9264,
INFO:root:Generator loss: 0.19177887908049993, Discriminator loss: 0.019740426380719458
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4589,SSNR: 7.2369,CSIG: 3.9200,CBAK: 3.1946,COVL: 3.2241,STOI: 0.9264,
INFO:root:Generator loss: 0.1964989240680422, Discriminator loss: 0.012436714821628161
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5257,SSNR: 7.4153,CSIG: 3.9952,CBAK: 3.2363,COVL: 3.2962,STOI: 0.9275,
INFO:root:Generator loss: 0.19114252073424204, Discriminator loss: 0.00933080758633358
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5149,SSNR: 7.5005,CSIG: 3.9811,CBAK: 3.2383,COVL: 3.2842,STOI: 0.9282,
INFO:root:Generator loss: 0.18607919769627707, Discriminator loss: 0.009767057906304086
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5569,SSNR: 7.2640,CSIG: 4.0198,CBAK: 3.2437,COVL: 3.3267,STOI: 0.9278,
INFO:root:Generator loss: 0.17484565717833384, Discriminator loss: 0.00933276695598449
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5638,SSNR: 7.7807,CSIG: 4.0255,CBAK: 3.2833,COVL: 3.3348,STOI: 0.9284,
INFO:root:Generator loss: 0.17300894004958017, Discriminator loss: 0.010170923745525735
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5690,SSNR: 8.0055,CSIG: 4.0318,CBAK: 3.3007,COVL: 3.3413,STOI: 0.9293,
INFO:root:Generator loss: 0.16443063744476863, Discriminator loss: 0.008544271878365959
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5887,SSNR: 7.9830,CSIG: 4.0397,CBAK: 3.3094,COVL: 3.3571,STOI: 0.9301,
INFO:root:Generator loss: 0.16199111832039698, Discriminator loss: 0.009532398677298002
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5948,SSNR: 8.2578,CSIG: 4.0389,CBAK: 3.3305,COVL: 3.3606,STOI: 0.9308,
INFO:root:Generator loss: 0.16129552785839354, Discriminator loss: 0.009683293157390185
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5986,SSNR: 8.3087,CSIG: 4.0466,CBAK: 3.3342,COVL: 3.3674,STOI: 0.9316,
INFO:root:Generator loss: 0.15853045561483928, Discriminator loss: 0.007974090287461877
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5977,SSNR: 8.5391,CSIG: 4.0452,CBAK: 3.3499,COVL: 3.3680,STOI: 0.9318,
INFO:root:Generator loss: 0.15584182739257812, Discriminator loss: 0.0138059084170631
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6050,SSNR: 8.4194,CSIG: 4.0471,CBAK: 3.3460,COVL: 3.3742,STOI: 0.9322,
Training finished.
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.04], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.4654821370329176, Discriminator loss: 0.40797360454286846
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.5224,SSNR: 1.3780,CSIG: 2.9555,CBAK: 2.2845,COVL: 2.2353,STOI: 0.8127,
INFO:root:Generator loss: 0.3671617976256779, Discriminator loss: 0.24248372656958445
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.7563,SSNR: 2.5617,CSIG: 3.3069,CBAK: 2.5213,COVL: 2.5464,STOI: 0.8612,
INFO:root:Generator loss: 0.34364337580544607, Discriminator loss: 0.13551824965647288
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.9058,SSNR: 2.5747,CSIG: 3.4208,CBAK: 2.6109,COVL: 2.6848,STOI: 0.8911,
INFO:root:Generator loss: 0.31021028757095337, Discriminator loss: 0.04671596655888217
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.1770,SSNR: 4.4111,CSIG: 3.6351,CBAK: 2.8599,COVL: 2.9297,STOI: 0.9012,
INFO:root:Generator loss: 0.3571555997644152, Discriminator loss: 0.07962109441203731
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2083,SSNR: 2.8947,CSIG: 3.6720,CBAK: 2.7782,COVL: 2.9634,STOI: 0.9095,
INFO:root:Generator loss: 0.2773258558341435, Discriminator loss: 0.02708445835326399
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2086,SSNR: 5.4251,CSIG: 3.6949,CBAK: 2.9454,COVL: 2.9777,STOI: 0.9135,
INFO:root:Generator loss: 0.2714909017086029, Discriminator loss: 0.028854545272354568
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2599,SSNR: 5.3919,CSIG: 3.7072,CBAK: 2.9664,COVL: 3.0093,STOI: 0.9106,
INFO:root:Generator loss: 0.26643160198416027, Discriminator loss: 0.017404388270473907
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2668,SSNR: 5.6310,CSIG: 3.7146,CBAK: 2.9866,COVL: 3.0171,STOI: 0.9163,
INFO:root:Generator loss: 0.25736814524446217, Discriminator loss: 0.016723339512412037
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3267,SSNR: 5.7196,CSIG: 3.7700,CBAK: 3.0240,COVL: 3.0760,STOI: 0.9174,
INFO:root:Generator loss: 0.2403044615473066, Discriminator loss: 0.0139301847666502
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3007,SSNR: 6.3520,CSIG: 3.7701,CBAK: 3.0553,COVL: 3.0644,STOI: 0.9198,
INFO:root:Generator loss: 0.23762911558151245, Discriminator loss: 0.01509767900487142
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3668,SSNR: 6.3016,CSIG: 3.8054,CBAK: 3.0882,COVL: 3.1169,STOI: 0.9212,
INFO:root:Generator loss: 0.24859353687082017, Discriminator loss: 0.011672128258006913
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3502,SSNR: 5.4591,CSIG: 3.8070,CBAK: 3.0284,COVL: 3.1098,STOI: 0.9228,
INFO:root:Generator loss: 0.23174721002578735, Discriminator loss: 0.011278114614209958
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3881,SSNR: 6.6808,CSIG: 3.8532,CBAK: 3.1190,COVL: 3.1512,STOI: 0.9215,
INFO:root:Generator loss: 0.226455100945064, Discriminator loss: 0.010477463282378656
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4618,SSNR: 6.5863,CSIG: 3.8868,CBAK: 3.1504,COVL: 3.2071,STOI: 0.9246,
INFO:root:Generator loss: 0.23528090757983072, Discriminator loss: 0.008584715143245245
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4184,SSNR: 7.0014,CSIG: 3.8671,CBAK: 3.1571,COVL: 3.1753,STOI: 0.9243,
INFO:root:Generator loss: 0.22212308645248413, Discriminator loss: 0.018306479789316654
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4370,SSNR: 6.9251,CSIG: 3.8862,CBAK: 3.1600,COVL: 3.1946,STOI: 0.9246,
INFO:root:Generator loss: 0.23181805227484023, Discriminator loss: 0.009194850189877408
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4861,SSNR: 6.3345,CSIG: 3.9003,CBAK: 3.1467,COVL: 3.2267,STOI: 0.9249,
INFO:root:Generator loss: 0.2246355414390564, Discriminator loss: 0.013982949179730244
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4302,SSNR: 7.2506,CSIG: 3.8738,CBAK: 3.1789,COVL: 3.1850,STOI: 0.9252,
INFO:root:Generator loss: 0.21703216859272548, Discriminator loss: 0.007572348046648715
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4305,SSNR: 7.3800,CSIG: 3.8811,CBAK: 3.1877,COVL: 3.1894,STOI: 0.9255,
INFO:root:Generator loss: 0.2296718635729381, Discriminator loss: 0.007374155069036143
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3846,SSNR: 5.8606,CSIG: 3.8311,CBAK: 3.0718,COVL: 3.1403,STOI: 0.9250,
INFO:root:Generator loss: 0.21844621641295298, Discriminator loss: 0.005617585432316575
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4584,SSNR: 7.3483,CSIG: 3.9100,CBAK: 3.1987,COVL: 3.2180,STOI: 0.9253,
INFO:root:Generator loss: 0.2146565637418202, Discriminator loss: 0.007795134343073836
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5171,SSNR: 6.5034,CSIG: 3.9362,CBAK: 3.1746,COVL: 3.2625,STOI: 0.9278,
INFO:root:Generator loss: 0.21046409010887146, Discriminator loss: 0.010025784373283386
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4878,SSNR: 7.5101,CSIG: 3.9318,CBAK: 3.2246,COVL: 3.2447,STOI: 0.9267,
INFO:root:Generator loss: 0.2149243482521602, Discriminator loss: 0.007015637986894164
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4780,SSNR: 6.9442,CSIG: 3.8992,CBAK: 3.1865,COVL: 3.2236,STOI: 0.9254,
INFO:root:Generator loss: 0.2046656118971961, Discriminator loss: 0.013683156842099769
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5153,SSNR: 7.4237,CSIG: 3.9327,CBAK: 3.2326,COVL: 3.2597,STOI: 0.9279,
INFO:root:Generator loss: 0.2047488178525652, Discriminator loss: 0.006052269434024181
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4830,SSNR: 7.6248,CSIG: 3.9184,CBAK: 3.2309,COVL: 3.2360,STOI: 0.9276,
INFO:root:Generator loss: 0.21112730034760066, Discriminator loss: 0.0060308414644428664
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5142,SSNR: 7.8285,CSIG: 3.9367,CBAK: 3.2587,COVL: 3.2617,STOI: 0.9283,
INFO:root:Generator loss: 0.20184732334954397, Discriminator loss: 0.005078597692772746
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4976,SSNR: 7.8046,CSIG: 3.9263,CBAK: 3.2486,COVL: 3.2474,STOI: 0.9281,
INFO:root:Generator loss: 0.20222594482558115, Discriminator loss: 0.007404835096427372
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5124,SSNR: 7.8963,CSIG: 3.9443,CBAK: 3.2626,COVL: 3.2649,STOI: 0.9288,
INFO:root:Generator loss: 0.20783044610704696, Discriminator loss: 0.005074770439283124
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4696,SSNR: 7.4268,CSIG: 3.9017,CBAK: 3.2137,COVL: 3.2215,STOI: 0.9269,
Training finished.
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.05], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.44813747916902813, Discriminator loss: 0.24723239243030548
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.6912,SSNR: 2.8718,CSIG: 3.1478,CBAK: 2.5001,COVL: 2.4309,STOI: 0.8707,
INFO:root:Generator loss: 0.3651136117322104, Discriminator loss: 0.15430340490170888
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.9333,SSNR: 3.9696,CSIG: 3.4211,CBAK: 2.7070,COVL: 2.6970,STOI: 0.8908,
INFO:root:Generator loss: 0.3287507380758013, Discriminator loss: 0.09090409481099673
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.1447,SSNR: 4.3674,CSIG: 3.5016,CBAK: 2.8432,COVL: 2.8475,STOI: 0.9030,
INFO:root:Generator loss: 0.2863213334764753, Discriminator loss: 0.18544325871126993
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.1604,SSNR: 4.7152,CSIG: 3.5799,CBAK: 2.8732,COVL: 2.8946,STOI: 0.9084,
INFO:root:Generator loss: 0.2873532474040985, Discriminator loss: 0.0746922641992569
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3001,SSNR: 4.8797,CSIG: 3.6902,CBAK: 2.9488,COVL: 3.0194,STOI: 0.9097,
INFO:root:Generator loss: 0.2606551753623145, Discriminator loss: 0.05058326652007444
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3383,SSNR: 5.4716,CSIG: 3.7483,CBAK: 3.0107,COVL: 3.0700,STOI: 0.9145,
INFO:root:Generator loss: 0.2654965945652553, Discriminator loss: 0.03301935829222202
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3658,SSNR: 5.5407,CSIG: 3.8049,CBAK: 3.0288,COVL: 3.1122,STOI: 0.9217,
INFO:root:Generator loss: 0.2586120516061783, Discriminator loss: 0.037059477397373745
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3840,SSNR: 5.7510,CSIG: 3.7965,CBAK: 3.0519,COVL: 3.1176,STOI: 0.9204,
INFO:root:Generator loss: 0.25005900859832764, Discriminator loss: 0.043563670212669034
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4108,SSNR: 5.5399,CSIG: 3.6758,CBAK: 3.0478,COVL: 3.0698,STOI: 0.9209,
INFO:root:Generator loss: 0.23362613788672856, Discriminator loss: 0.030740688421896527
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4472,SSNR: 6.7522,CSIG: 3.8399,CBAK: 3.1450,COVL: 3.1710,STOI: 0.9253,
INFO:root:Generator loss: 0.234051770397595, Discriminator loss: 0.019488038761275157
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4222,SSNR: 6.7714,CSIG: 3.8833,CBAK: 3.1344,COVL: 3.1801,STOI: 0.9256,
INFO:root:Generator loss: 0.23131742434842245, Discriminator loss: 0.02264733479491302
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4959,SSNR: 6.4718,CSIG: 3.8608,CBAK: 3.1520,COVL: 3.2066,STOI: 0.9242,
INFO:root:Generator loss: 0.22705617547035217, Discriminator loss: 0.021413430072633282
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4838,SSNR: 7.0399,CSIG: 3.9369,CBAK: 3.1836,COVL: 3.2400,STOI: 0.9270,
INFO:root:Generator loss: 0.2150220913546426, Discriminator loss: 0.02164618910423347
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4607,SSNR: 6.9395,CSIG: 3.9153,CBAK: 3.1674,COVL: 3.2178,STOI: 0.9258,
INFO:root:Generator loss: 0.22376290602343424, Discriminator loss: 0.012778252895389284
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5053,SSNR: 7.1642,CSIG: 3.9645,CBAK: 3.2035,COVL: 3.2661,STOI: 0.9276,
INFO:root:Generator loss: 0.22563765943050385, Discriminator loss: 0.032904522227389474
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4973,SSNR: 7.0503,CSIG: 3.9579,CBAK: 3.1924,COVL: 3.2591,STOI: 0.9273,
INFO:root:Generator loss: 0.20929049806935446, Discriminator loss: 0.015083422485206808
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5216,SSNR: 7.2213,CSIG: 3.9824,CBAK: 3.2170,COVL: 3.2847,STOI: 0.9265,
INFO:root:Generator loss: 0.20699451863765717, Discriminator loss: 0.014379364837493216
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5319,SSNR: 7.4417,CSIG: 3.9685,CBAK: 3.2338,COVL: 3.2825,STOI: 0.9281,
INFO:root:Generator loss: 0.21554802783897944, Discriminator loss: 0.013793961278029851
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4905,SSNR: 7.5212,CSIG: 3.9627,CBAK: 3.2214,COVL: 3.2598,STOI: 0.9284,
INFO:root:Generator loss: 0.207045316696167, Discriminator loss: 0.011533956974744797
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5450,SSNR: 7.4788,CSIG: 4.0073,CBAK: 3.2464,COVL: 3.3110,STOI: 0.9273,
INFO:root:Generator loss: 0.20434878766536713, Discriminator loss: 0.018255816107349738
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5122,SSNR: 7.5208,CSIG: 3.9749,CBAK: 3.2346,COVL: 3.2788,STOI: 0.9286,
INFO:root:Generator loss: 0.19739268720149994, Discriminator loss: 0.00619759743234941
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5524,SSNR: 7.6694,CSIG: 4.0216,CBAK: 3.2637,COVL: 3.3234,STOI: 0.9288,
INFO:root:Generator loss: 0.19145851475851877, Discriminator loss: 0.016222988521414145
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5447,SSNR: 7.7342,CSIG: 4.0017,CBAK: 3.2639,COVL: 3.3098,STOI: 0.9298,
INFO:root:Generator loss: 0.1903527123587472, Discriminator loss: 0.014307842057730471
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5681,SSNR: 7.4262,CSIG: 4.0309,CBAK: 3.2562,COVL: 3.3376,STOI: 0.9301,
INFO:root:Generator loss: 0.1850286317723138, Discriminator loss: 0.012710723227688245
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5819,SSNR: 8.1006,CSIG: 4.0420,CBAK: 3.3099,COVL: 3.3540,STOI: 0.9306,
INFO:root:Generator loss: 0.1789476956639971, Discriminator loss: 0.01238575461320579
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5952,SSNR: 8.2245,CSIG: 4.0383,CBAK: 3.3216,COVL: 3.3601,STOI: 0.9314,
INFO:root:Generator loss: 0.1754582385931696, Discriminator loss: 0.009282596558997673
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5664,SSNR: 8.4093,CSIG: 4.0326,CBAK: 3.3216,COVL: 3.3413,STOI: 0.9320,
INFO:root:Generator loss: 0.17844643124512263, Discriminator loss: 0.008183228350909693
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5968,SSNR: 8.1255,CSIG: 4.0448,CBAK: 3.3166,COVL: 3.3671,STOI: 0.9324,
INFO:root:Generator loss: 0.17329083808830806, Discriminator loss: 0.008897932379373483
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5994,SSNR: 8.5019,CSIG: 4.0460,CBAK: 3.3430,COVL: 3.3692,STOI: 0.9325,
INFO:root:Generator loss: 0.17493394123656408, Discriminator loss: 0.005180210240983537
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5958,SSNR: 8.5834,CSIG: 4.0485,CBAK: 3.3482,COVL: 3.3689,STOI: 0.9324,
Training finished.
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.06], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.3186542349202292, Discriminator loss: 0.42273287900856565
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.0195,SSNR: 3.2296,CSIG: 3.4467,CBAK: 2.7202,COVL: 2.7600,STOI: 0.9022,
INFO:root:Generator loss: 0.25389373302459717, Discriminator loss: 0.23193947119372232
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2972,SSNR: 5.2209,CSIG: 3.7488,CBAK: 2.9830,COVL: 3.0522,STOI: 0.9161,
INFO:root:Generator loss: 0.22502814446176803, Discriminator loss: 0.2694916192974363
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3607,SSNR: 6.3170,CSIG: 3.8235,CBAK: 3.0868,COVL: 3.1257,STOI: 0.9253,
INFO:root:Generator loss: 0.2119520115000861, Discriminator loss: 0.21056741263185227
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4059,SSNR: 7.1233,CSIG: 3.8627,CBAK: 3.1588,COVL: 3.1684,STOI: 0.9257,
INFO:root:Generator loss: 0.20929907049451554, Discriminator loss: 0.16297292922224318
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4437,SSNR: 6.9185,CSIG: 3.8952,CBAK: 3.1614,COVL: 3.2042,STOI: 0.9283,
INFO:root:Generator loss: 0.19954424670764379, Discriminator loss: 0.10829639115503856
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4378,SSNR: 7.6156,CSIG: 3.8745,CBAK: 3.2046,COVL: 3.1896,STOI: 0.9292,
INFO:root:Generator loss: 0.19394506088324956, Discriminator loss: 0.05022670115743365
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5173,SSNR: 7.3487,CSIG: 3.9240,CBAK: 3.2264,COVL: 3.2599,STOI: 0.9291,
INFO:root:Generator loss: 0.20627074262925557, Discriminator loss: 0.03515952133706638
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4938,SSNR: 7.3573,CSIG: 3.9288,CBAK: 3.2130,COVL: 3.2521,STOI: 0.9309,
INFO:root:Generator loss: 0.19575138177190507, Discriminator loss: 0.014836056956223078
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5217,SSNR: 8.1480,CSIG: 3.9159,CBAK: 3.2772,COVL: 3.2533,STOI: 0.9288,
INFO:root:Generator loss: 0.1908308161156518, Discriminator loss: 0.017384234549743787
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5463,SSNR: 8.2883,CSIG: 3.9584,CBAK: 3.3008,COVL: 3.2938,STOI: 0.9313,
INFO:root:Generator loss: 0.18495217391422816, Discriminator loss: 0.009660894417070917
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5461,SSNR: 8.5620,CSIG: 3.9648,CBAK: 3.3170,COVL: 3.2957,STOI: 0.9320,
INFO:root:Generator loss: 0.1979009062051773, Discriminator loss: 0.007274734172304826
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5671,SSNR: 7.3243,CSIG: 3.9758,CBAK: 3.2468,COVL: 3.3113,STOI: 0.9318,
INFO:root:Generator loss: 0.1915886402130127, Discriminator loss: 0.005478396745664733
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5241,SSNR: 8.3051,CSIG: 3.9576,CBAK: 3.2912,COVL: 3.2825,STOI: 0.9329,
INFO:root:Generator loss: 0.18229504781109945, Discriminator loss: 0.0067289178259670734
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5641,SSNR: 8.8514,CSIG: 3.9892,CBAK: 3.3440,COVL: 3.3200,STOI: 0.9325,
INFO:root:Generator loss: 0.1816093378833362, Discriminator loss: 0.010813546633081777
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5480,SSNR: 8.7421,CSIG: 3.9717,CBAK: 3.3289,COVL: 3.3007,STOI: 0.9327,
INFO:root:Generator loss: 0.18120095133781433, Discriminator loss: 0.010937117106680359
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5750,SSNR: 8.9853,CSIG: 3.9988,CBAK: 3.3573,COVL: 3.3313,STOI: 0.9333,
INFO:root:Generator loss: 0.17623390150921686, Discriminator loss: 0.01143886782561562
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5573,SSNR: 8.9742,CSIG: 3.9740,CBAK: 3.3488,COVL: 3.3067,STOI: 0.9328,
INFO:root:Generator loss: 0.18365611348833358, Discriminator loss: 0.008293531901602234
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5831,SSNR: 8.8325,CSIG: 4.0051,CBAK: 3.3525,COVL: 3.3392,STOI: 0.9331,
INFO:root:Generator loss: 0.18903426826000214, Discriminator loss: 0.0077600185094135144
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5461,SSNR: 7.2259,CSIG: 3.9754,CBAK: 3.2367,COVL: 3.3046,STOI: 0.9333,
INFO:root:Generator loss: 0.18382103741168976, Discriminator loss: 0.008850253719304289
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5539,SSNR: 7.7186,CSIG: 3.9674,CBAK: 3.2682,COVL: 3.3007,STOI: 0.9328,
INFO:root:Generator loss: 0.17566428865705216, Discriminator loss: 0.004781408434999841
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5538,SSNR: 9.0401,CSIG: 3.9854,CBAK: 3.3546,COVL: 3.3129,STOI: 0.9338,
INFO:root:Generator loss: 0.1684499734214374, Discriminator loss: 0.008009738654696516
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5631,SSNR: 9.2941,CSIG: 3.9983,CBAK: 3.3754,COVL: 3.3257,STOI: 0.9338,
INFO:root:Generator loss: 0.17614803995404923, Discriminator loss: 0.005580477749130556
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5558,SSNR: 8.4206,CSIG: 3.9904,CBAK: 3.3157,COVL: 3.3172,STOI: 0.9339,
INFO:root:Generator loss: 0.1832752036196845, Discriminator loss: 0.022728919317679747
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4912,SSNR: 7.8028,CSIG: 3.8636,CBAK: 3.2488,COVL: 3.2144,STOI: 0.9317,
INFO:root:Generator loss: 0.17862611583301, Discriminator loss: 0.017101042172206298
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5558,SSNR: 8.5512,CSIG: 3.9690,CBAK: 3.3237,COVL: 3.3042,STOI: 0.9329,
INFO:root:Generator loss: 0.16920003507818496, Discriminator loss: 0.010692348554065185
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5326,SSNR: 8.3890,CSIG: 3.9615,CBAK: 3.3056,COVL: 3.2897,STOI: 0.9335,
INFO:root:Generator loss: 0.17369437537023, Discriminator loss: 0.017086914873548915
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5451,SSNR: 8.2753,CSIG: 3.9711,CBAK: 3.3021,COVL: 3.3004,STOI: 0.9338,
INFO:root:Generator loss: 0.16603590441601618, Discriminator loss: 0.0164543183054775
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5204,SSNR: 8.8275,CSIG: 3.9440,CBAK: 3.3284,COVL: 3.2739,STOI: 0.9331,
INFO:root:Generator loss: 0.16565291051353728, Discriminator loss: 0.011091082822531462
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5446,SSNR: 9.3075,CSIG: 3.9684,CBAK: 3.3687,COVL: 3.2999,STOI: 0.9333,
INFO:root:Generator loss: 0.16886654709066665, Discriminator loss: 0.010338439872222287
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5349,SSNR: 8.4684,CSIG: 3.9610,CBAK: 3.3134,COVL: 3.2917,STOI: 0.9331,
Training finished.
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.07], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.34782699601990835, Discriminator loss: 0.23122469655105046
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.9196,SSNR: 3.7862,CSIG: 3.4155,CBAK: 2.6978,COVL: 2.6906,STOI: 0.8815,
INFO:root:Generator loss: 0.3008000786815371, Discriminator loss: 0.1738262666123254
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.0984,SSNR: 5.0328,CSIG: 3.5090,CBAK: 2.8684,COVL: 2.8298,STOI: 0.9089,
INFO:root:Generator loss: 0.2601321701492582, Discriminator loss: 0.09495341671364647
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3450,SSNR: 6.3161,CSIG: 3.7799,CBAK: 3.0754,COVL: 3.0920,STOI: 0.9192,
INFO:root:Generator loss: 0.2544458231755665, Discriminator loss: 0.052801000220435004
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3132,SSNR: 6.4418,CSIG: 3.7414,CBAK: 3.0702,COVL: 3.0576,STOI: 0.9240,
INFO:root:Generator loss: 0.2462119609117508, Discriminator loss: 0.06708681476967675
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3935,SSNR: 5.5693,CSIG: 3.8430,CBAK: 3.0557,COVL: 3.1507,STOI: 0.9245,
INFO:root:Generator loss: 0.24581086848463332, Discriminator loss: 0.02120072501046317
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4224,SSNR: 7.1021,CSIG: 3.8697,CBAK: 3.1640,COVL: 3.1794,STOI: 0.9268,
INFO:root:Generator loss: 0.22081164802823747, Discriminator loss: 0.008565453479864768
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4646,SSNR: 7.4646,CSIG: 3.9125,CBAK: 3.2084,COVL: 3.2235,STOI: 0.9289,
INFO:root:Generator loss: 0.22176275934491838, Discriminator loss: 0.022660069101090943
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4233,SSNR: 7.3086,CSIG: 3.8342,CBAK: 3.1799,COVL: 3.1602,STOI: 0.9288,
INFO:root:Generator loss: 0.21486373245716095, Discriminator loss: 0.009568811693627919
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4938,SSNR: 7.9981,CSIG: 3.9160,CBAK: 3.2561,COVL: 3.2407,STOI: 0.9293,
INFO:root:Generator loss: 0.20779831068856375, Discriminator loss: 0.019848827804837908
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5286,SSNR: 7.8898,CSIG: 3.9367,CBAK: 3.2672,COVL: 3.2681,STOI: 0.9301,
INFO:root:Generator loss: 0.21450420788356236, Discriminator loss: 0.007031137423057642
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5131,SSNR: 7.3800,CSIG: 3.9344,CBAK: 3.2283,COVL: 3.2606,STOI: 0.9305,
INFO:root:Generator loss: 0.20369587625776017, Discriminator loss: 0.013433548089648997
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4685,SSNR: 7.9235,CSIG: 3.8743,CBAK: 3.2405,COVL: 3.2044,STOI: 0.9284,
INFO:root:Generator loss: 0.1928015010697501, Discriminator loss: 0.012823098804801702
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5219,SSNR: 8.1385,CSIG: 3.9555,CBAK: 3.2780,COVL: 3.2762,STOI: 0.9310,
INFO:root:Generator loss: 0.20321795344352722, Discriminator loss: 0.00805125801291849
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5116,SSNR: 8.2598,CSIG: 3.9351,CBAK: 3.2825,COVL: 3.2590,STOI: 0.9308,
INFO:root:Generator loss: 0.1947457024029323, Discriminator loss: 0.011401837092957326
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5227,SSNR: 8.4031,CSIG: 3.9492,CBAK: 3.2961,COVL: 3.2737,STOI: 0.9316,
INFO:root:Generator loss: 0.18904516313757216, Discriminator loss: 0.009580254554748535
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5433,SSNR: 8.7699,CSIG: 3.9655,CBAK: 3.3298,COVL: 3.2945,STOI: 0.9320,
INFO:root:Generator loss: 0.18753852163042342, Discriminator loss: 0.005518002568611077
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5290,SSNR: 8.7964,CSIG: 3.9594,CBAK: 3.3251,COVL: 3.2838,STOI: 0.9323,
INFO:root:Generator loss: 0.1925268747976848, Discriminator loss: 0.007884536038285919
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5274,SSNR: 7.5595,CSIG: 3.9448,CBAK: 3.2448,COVL: 3.2728,STOI: 0.9312,
INFO:root:Generator loss: 0.1837508167539324, Discriminator loss: 0.011755293900413173
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5695,SSNR: 8.8390,CSIG: 3.9866,CBAK: 3.3479,COVL: 3.3199,STOI: 0.9322,
INFO:root:Generator loss: 0.1783317540373121, Discriminator loss: 0.03357854126287358
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5280,SSNR: 8.7920,CSIG: 3.9696,CBAK: 3.3252,COVL: 3.2886,STOI: 0.9330,
INFO:root:Generator loss: 0.18477310772453034, Discriminator loss: 0.01818634044112904
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5159,SSNR: 8.8536,CSIG: 3.9510,CBAK: 3.3243,COVL: 3.2725,STOI: 0.9326,
INFO:root:Generator loss: 0.1868915238550731, Discriminator loss: 0.008478244034839528
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5538,SSNR: 9.0816,CSIG: 3.9815,CBAK: 3.3573,COVL: 3.3097,STOI: 0.9331,
INFO:root:Generator loss: 0.19437902101448604, Discriminator loss: 0.015139541788292783
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5496,SSNR: 6.9697,CSIG: 3.9910,CBAK: 3.2194,COVL: 3.3135,STOI: 0.9337,
INFO:root:Generator loss: 0.18024068432194845, Discriminator loss: 0.02077202612001981
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5444,SSNR: 8.0987,CSIG: 3.9727,CBAK: 3.2926,COVL: 3.3005,STOI: 0.9327,
INFO:root:Generator loss: 0.18245639119829452, Discriminator loss: 0.010119738522917032
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5511,SSNR: 7.8719,CSIG: 3.9839,CBAK: 3.2797,COVL: 3.3084,STOI: 0.9334,
INFO:root:Generator loss: 0.1755883725626128, Discriminator loss: 0.005291861748056752
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5427,SSNR: 8.8471,CSIG: 3.9729,CBAK: 3.3397,COVL: 3.2991,STOI: 0.9337,
INFO:root:Generator loss: 0.18278024664946965, Discriminator loss: 0.006891706625797919
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5623,SSNR: 8.5371,CSIG: 4.0034,CBAK: 3.3277,COVL: 3.3258,STOI: 0.9340,
INFO:root:Generator loss: 0.16782347112894058, Discriminator loss: 0.020753687380680015
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5453,SSNR: 9.0403,CSIG: 3.9855,CBAK: 3.3536,COVL: 3.3089,STOI: 0.9338,
INFO:root:Generator loss: 0.16851340660027095, Discriminator loss: 0.01416767667979002
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5395,SSNR: 9.2911,CSIG: 3.9738,CBAK: 3.3659,COVL: 3.2995,STOI: 0.9335,
INFO:root:Generator loss: 0.171672380396298, Discriminator loss: 0.008471510572625058
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5339,SSNR: 9.1076,CSIG: 3.9560,CBAK: 3.3518,COVL: 3.2850,STOI: 0.9336,
Training finished.
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.08], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.3927123376301357, Discriminator loss: 0.3209320455789566
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.8983,SSNR: 3.3158,CSIG: 3.3760,CBAK: 2.6399,COVL: 2.6536,STOI: 0.8761,
INFO:root:Generator loss: 0.36414029342787607, Discriminator loss: 0.349265102829252
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.9262,SSNR: 3.6395,CSIG: 3.4091,CBAK: 2.6900,COVL: 2.6901,STOI: 0.8970,
INFO:root:Generator loss: 0.3329306628022875, Discriminator loss: 0.2279551774263382
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.1639,SSNR: 4.2079,CSIG: 3.6775,CBAK: 2.8438,COVL: 2.9452,STOI: 0.9050,
INFO:root:Generator loss: 0.2898713392870767, Discriminator loss: 0.1956783788544791
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2971,SSNR: 5.5310,CSIG: 3.7445,CBAK: 2.9957,COVL: 3.0476,STOI: 0.9125,
INFO:root:Generator loss: 0.2874521442822048, Discriminator loss: 0.15914750737803324
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2837,SSNR: 5.8092,CSIG: 3.7377,CBAK: 3.0049,COVL: 3.0368,STOI: 0.9181,
INFO:root:Generator loss: 0.2787493254457201, Discriminator loss: 0.21394541646753037
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3000,SSNR: 5.5162,CSIG: 3.7552,CBAK: 2.9898,COVL: 3.0521,STOI: 0.9149,
INFO:root:Generator loss: 0.28250311953680857, Discriminator loss: 0.20391833462885448
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3124,SSNR: 4.9698,CSIG: 3.7527,CBAK: 2.9720,COVL: 3.0609,STOI: 0.9162,
INFO:root:Generator loss: 0.27212219153131756, Discriminator loss: 0.14046653040817805
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3479,SSNR: 5.8515,CSIG: 3.8075,CBAK: 3.0404,COVL: 3.1046,STOI: 0.9145,
INFO:root:Generator loss: 0.27436812009130207, Discriminator loss: 0.1658502221107483
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4060,SSNR: 5.1398,CSIG: 3.8598,CBAK: 3.0244,COVL: 3.1609,STOI: 0.9246,
INFO:root:Generator loss: 0.284909046122006, Discriminator loss: 0.10475677464689527
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3425,SSNR: 5.5877,CSIG: 3.8257,CBAK: 3.0246,COVL: 3.1122,STOI: 0.9200,
INFO:root:Generator loss: 0.25761258602142334, Discriminator loss: 0.034516752298389165
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4451,SSNR: 6.7348,CSIG: 3.8813,CBAK: 3.1474,COVL: 3.1930,STOI: 0.9248,
INFO:root:Generator loss: 0.2569053556237902, Discriminator loss: 0.01878846130732979
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4626,SSNR: 6.8164,CSIG: 3.8953,CBAK: 3.1590,COVL: 3.2084,STOI: 0.9253,
INFO:root:Generator loss: 0.2472079715558461, Discriminator loss: 0.0180697312711605
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4656,SSNR: 7.0907,CSIG: 3.9043,CBAK: 3.1797,COVL: 3.2145,STOI: 0.9257,
INFO:root:Generator loss: 0.24451077623026712, Discriminator loss: 0.029951739257999828
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4436,SSNR: 7.0046,CSIG: 3.8769,CBAK: 3.1621,COVL: 3.1894,STOI: 0.9264,
INFO:root:Generator loss: 0.25155983226639883, Discriminator loss: 0.020483927269067084
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4555,SSNR: 7.1111,CSIG: 3.9001,CBAK: 3.1743,COVL: 3.2074,STOI: 0.9269,
INFO:root:Generator loss: 0.23499372175761632, Discriminator loss: 0.025801336392760277
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4974,SSNR: 7.1466,CSIG: 3.9370,CBAK: 3.1992,COVL: 3.2487,STOI: 0.9265,
INFO:root:Generator loss: 0.2356629946402141, Discriminator loss: 0.025426532407956465
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5146,SSNR: 7.0899,CSIG: 3.9397,CBAK: 3.2033,COVL: 3.2592,STOI: 0.9274,
INFO:root:Generator loss: 0.2144682662827628, Discriminator loss: 0.03423109530870404
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4850,SSNR: 7.3342,CSIG: 3.9285,CBAK: 3.2074,COVL: 3.2422,STOI: 0.9269,
INFO:root:Generator loss: 0.22486009342329843, Discriminator loss: 0.02129481127485633
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5566,SSNR: 6.5466,CSIG: 3.9692,CBAK: 3.1912,COVL: 3.2990,STOI: 0.9282,
INFO:root:Generator loss: 0.22044111788272858, Discriminator loss: 0.019931954265172993
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5478,SSNR: 7.4328,CSIG: 3.9708,CBAK: 3.2467,COVL: 3.2986,STOI: 0.9295,
INFO:root:Generator loss: 0.20405220133917673, Discriminator loss: 0.02938871824049524
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6039,SSNR: 8.0307,CSIG: 4.0086,CBAK: 3.3116,COVL: 3.3492,STOI: 0.9296,
INFO:root:Generator loss: 0.20048840450389044, Discriminator loss: 0.014396585108313178
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6153,SSNR: 8.4035,CSIG: 4.0209,CBAK: 3.3397,COVL: 3.3640,STOI: 0.9310,
INFO:root:Generator loss: 0.2002142412321908, Discriminator loss: 0.02374660223722458
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5979,SSNR: 8.4902,CSIG: 4.0037,CBAK: 3.3386,COVL: 3.3463,STOI: 0.9317,
INFO:root:Generator loss: 0.19947166528020585, Discriminator loss: 0.011324301794437426
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5747,SSNR: 8.4316,CSIG: 3.9940,CBAK: 3.3221,COVL: 3.3306,STOI: 0.9317,
INFO:root:Generator loss: 0.19049988899912154, Discriminator loss: 0.02118699235974678
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5942,SSNR: 8.4117,CSIG: 4.0121,CBAK: 3.3305,COVL: 3.3482,STOI: 0.9315,
INFO:root:Generator loss: 0.19226952003581183, Discriminator loss: 0.01384728676306882
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6016,SSNR: 8.7073,CSIG: 4.0171,CBAK: 3.3535,COVL: 3.3550,STOI: 0.9319,
INFO:root:Generator loss: 0.19580806366034917, Discriminator loss: 0.025233791708680137
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5995,SSNR: 8.7240,CSIG: 4.0172,CBAK: 3.3535,COVL: 3.3565,STOI: 0.9327,
INFO:root:Generator loss: 0.18830654237951552, Discriminator loss: 0.008577779999801092
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6024,SSNR: 8.8387,CSIG: 4.0175,CBAK: 3.3623,COVL: 3.3581,STOI: 0.9332,
INFO:root:Generator loss: 0.18798479437828064, Discriminator loss: 0.012235898324953658
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6257,SSNR: 8.9680,CSIG: 4.0348,CBAK: 3.3823,COVL: 3.3783,STOI: 0.9330,
INFO:root:Generator loss: 0.1882100264940943, Discriminator loss: 0.012623661862952369
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6357,SSNR: 8.7140,CSIG: 4.0388,CBAK: 3.3708,COVL: 3.3851,STOI: 0.9330,
Training finished.
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.09], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.46550467184611727, Discriminator loss: 0.5361207979066032
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.7284,SSNR: 2.9689,CSIG: 3.1490,CBAK: 2.5301,COVL: 2.4525,STOI: 0.8736,
INFO:root:Generator loss: 0.3886717515332358, Discriminator loss: 0.49027635369982037
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.9507,SSNR: 3.6951,CSIG: 3.4252,CBAK: 2.7089,COVL: 2.7118,STOI: 0.9000,
INFO:root:Generator loss: 0.34512278011866976, Discriminator loss: 0.2603541186877659
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.1292,SSNR: 4.4621,CSIG: 3.5392,CBAK: 2.8446,COVL: 2.8594,STOI: 0.9010,
INFO:root:Generator loss: 0.31413707988602774, Discriminator loss: 0.2620362916163036
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.1765,SSNR: 5.3627,CSIG: 3.6112,CBAK: 2.9244,COVL: 2.9193,STOI: 0.9154,
INFO:root:Generator loss: 0.3033212551048824, Discriminator loss: 0.17080838339669363
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2999,SSNR: 6.3911,CSIG: 3.7727,CBAK: 3.0544,COVL: 3.0642,STOI: 0.9197,
INFO:root:Generator loss: 0.2866203359195164, Discriminator loss: 0.09644252274717603
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3622,SSNR: 6.6198,CSIG: 3.8079,CBAK: 3.0995,COVL: 3.1147,STOI: 0.9238,
INFO:root:Generator loss: 0.2814944727080209, Discriminator loss: 0.03142583529864039
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4071,SSNR: 7.0147,CSIG: 3.8506,CBAK: 3.1474,COVL: 3.1589,STOI: 0.9239,
INFO:root:Generator loss: 0.2781628157411303, Discriminator loss: 0.025842616068465368
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4605,SSNR: 7.2584,CSIG: 3.8975,CBAK: 3.1897,COVL: 3.2108,STOI: 0.9256,
INFO:root:Generator loss: 0.2740014238016946, Discriminator loss: 0.022205814053969725
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4819,SSNR: 7.5640,CSIG: 3.8906,CBAK: 3.2203,COVL: 3.2195,STOI: 0.9269,
INFO:root:Generator loss: 0.2629783196108682, Discriminator loss: 0.02363296814395913
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4776,SSNR: 7.2662,CSIG: 3.8749,CBAK: 3.2014,COVL: 3.2099,STOI: 0.9269,
INFO:root:Generator loss: 0.25538925400802065, Discriminator loss: 0.00968965156269925
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4921,SSNR: 7.6340,CSIG: 3.8828,CBAK: 3.2316,COVL: 3.2204,STOI: 0.9260,
INFO:root:Generator loss: 0.2441260027033942, Discriminator loss: 0.016847048087843826
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5353,SSNR: 7.3210,CSIG: 3.9620,CBAK: 3.2307,COVL: 3.2838,STOI: 0.9295,
INFO:root:Generator loss: 0.24083649686404637, Discriminator loss: 0.018961577343621423
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5204,SSNR: 8.1746,CSIG: 3.9509,CBAK: 3.2809,COVL: 3.2720,STOI: 0.9296,
INFO:root:Generator loss: 0.23082539439201355, Discriminator loss: 0.018394843941288336
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5514,SSNR: 8.1473,CSIG: 3.9827,CBAK: 3.2931,COVL: 3.3057,STOI: 0.9299,
INFO:root:Generator loss: 0.22876552598817007, Discriminator loss: 0.016969953131462847
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5594,SSNR: 8.3571,CSIG: 3.9824,CBAK: 3.3095,COVL: 3.3088,STOI: 0.9304,
INFO:root:Generator loss: 0.2384293100663594, Discriminator loss: 0.021238459640049508
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5709,SSNR: 6.9443,CSIG: 4.0017,CBAK: 3.2250,COVL: 3.3264,STOI: 0.9306,
INFO:root:Generator loss: 0.22444501093455724, Discriminator loss: 0.016983910064612116
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5386,SSNR: 8.0258,CSIG: 3.9787,CBAK: 3.2802,COVL: 3.2994,STOI: 0.9310,
INFO:root:Generator loss: 0.21965122435774123, Discriminator loss: 0.011136556310313088
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5671,SSNR: 8.2824,CSIG: 3.9993,CBAK: 3.3121,COVL: 3.3226,STOI: 0.9302,
INFO:root:Generator loss: 0.2148910335132054, Discriminator loss: 0.017666220465408906
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5693,SSNR: 8.5694,CSIG: 4.0040,CBAK: 3.3305,COVL: 3.3297,STOI: 0.9317,
INFO:root:Generator loss: 0.21525491986955916, Discriminator loss: 0.009993316140025854
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5699,SSNR: 8.4854,CSIG: 3.9972,CBAK: 3.3246,COVL: 3.3256,STOI: 0.9320,
INFO:root:Generator loss: 0.21338714020592825, Discriminator loss: 0.008604399327720915
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5776,SSNR: 8.6246,CSIG: 4.0147,CBAK: 3.3376,COVL: 3.3395,STOI: 0.9323,
INFO:root:Generator loss: 0.1998744841132845, Discriminator loss: 0.014645776245743036
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5589,SSNR: 8.9156,CSIG: 3.9985,CBAK: 3.3511,COVL: 3.3221,STOI: 0.9324,
INFO:root:Generator loss: 0.20172175552163804, Discriminator loss: 0.020987238668437515
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6002,SSNR: 8.0442,CSIG: 4.0377,CBAK: 3.3131,COVL: 3.3642,STOI: 0.9329,
INFO:root:Generator loss: 0.1952449083328247, Discriminator loss: 0.00902985645058964
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5983,SSNR: 8.3474,CSIG: 4.0349,CBAK: 3.3335,COVL: 3.3633,STOI: 0.9333,
INFO:root:Generator loss: 0.2053760588169098, Discriminator loss: 0.010836281214973756
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5581,SSNR: 8.8670,CSIG: 4.0113,CBAK: 3.3490,COVL: 3.3303,STOI: 0.9334,
INFO:root:Generator loss: 0.19884406243051803, Discriminator loss: 0.009639882648895894
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5626,SSNR: 9.1213,CSIG: 4.0053,CBAK: 3.3675,COVL: 3.3278,STOI: 0.9331,
INFO:root:Generator loss: 0.19434357966695512, Discriminator loss: 0.009198645894814814
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6014,SSNR: 9.0412,CSIG: 4.0406,CBAK: 3.3789,COVL: 3.3676,STOI: 0.9336,
INFO:root:Generator loss: 0.19398338879857743, Discriminator loss: 0.010640437215832728
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5874,SSNR: 8.8390,CSIG: 4.0325,CBAK: 3.3597,COVL: 3.3560,STOI: 0.9338,
INFO:root:Generator loss: 0.18904490981783187, Discriminator loss: 0.011461529614669936
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5912,SSNR: 9.1460,CSIG: 4.0323,CBAK: 3.3835,COVL: 3.3577,STOI: 0.9337,
INFO:root:Generator loss: 0.19815721895013536, Discriminator loss: 0.012535256134080035
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5983,SSNR: 9.2790,CSIG: 4.0385,CBAK: 3.3966,COVL: 3.3645,STOI: 0.9337,
Training finished.
Namespace(batch_size=4, cut_len=32000, data_dir='/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/Dataset', decay_epoch=12, epochs=30, init_lr=0.0005, log_interval=500, loss_weights=[0.1, 0.9, 0.2, 0.05, 0.1], save_model_dir='./saved_models_log/saved_models_20250801_Samplesets')
['NVIDIA A100-SXM4-80GB']
====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
TSCNet                                             [1, 1, 321, 201]          --
├─DenseEncoder: 1-1                                [1, 64, 321, 101]         --
│    └─Sequential: 2-1                             [1, 64, 321, 201]         --
│    │    └─Conv2d: 3-1                            [1, 64, 321, 201]         256
│    │    └─InstanceNorm2d: 3-2                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-3                             [1, 64, 321, 201]         64
│    └─DilatedDenseNet: 2-2                        [1, 64, 321, 201]         --
│    │    └─ConstantPad2d: 3-4                     [1, 64, 322, 203]         --
│    │    └─Conv2d: 3-5                            [1, 64, 321, 201]         24,640
│    │    └─InstanceNorm2d: 3-6                    [1, 64, 321, 201]         128
│    │    └─PReLU: 3-7                             [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-8                     [1, 128, 323, 203]        --
│    │    └─Conv2d: 3-9                            [1, 64, 321, 201]         49,216
│    │    └─InstanceNorm2d: 3-10                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-11                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-12                    [1, 192, 325, 203]        --
│    │    └─Conv2d: 3-13                           [1, 64, 321, 201]         73,792
│    │    └─InstanceNorm2d: 3-14                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-15                            [1, 64, 321, 201]         64
│    │    └─ConstantPad2d: 3-16                    [1, 256, 329, 203]        --
│    │    └─Conv2d: 3-17                           [1, 64, 321, 201]         98,368
│    │    └─InstanceNorm2d: 3-18                   [1, 64, 321, 201]         128
│    │    └─PReLU: 3-19                            [1, 64, 321, 201]         64
│    └─Sequential: 2-3                             [1, 64, 321, 101]         --
│    │    └─Conv2d: 3-20                           [1, 64, 321, 101]         12,352
│    │    └─InstanceNorm2d: 3-21                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-22                            [1, 64, 321, 101]         64
├─TSCB: 1-2                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-4                         [101, 321, 64]            --
│    │    └─Scale: 3-23                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-24                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-25              [101, 321, 64]            29,376
│    │    └─Scale: 3-26                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-27                        [101, 321, 64]            128
│    └─ConformerBlock: 2-5                         [321, 101, 64]            --
│    │    └─Scale: 3-28                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-29                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-30              [321, 101, 64]            29,376
│    │    └─Scale: 3-31                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-32                        [321, 101, 64]            128
├─TSCB: 1-3                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-6                         [101, 321, 64]            --
│    │    └─Scale: 3-33                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-34                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-35              [101, 321, 64]            29,376
│    │    └─Scale: 3-36                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-37                        [101, 321, 64]            128
│    └─ConformerBlock: 2-7                         [321, 101, 64]            --
│    │    └─Scale: 3-38                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-39                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-40              [321, 101, 64]            29,376
│    │    └─Scale: 3-41                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-42                        [321, 101, 64]            128
├─TSCB: 1-4                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-8                         [101, 321, 64]            --
│    │    └─Scale: 3-43                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-44                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-45              [101, 321, 64]            29,376
│    │    └─Scale: 3-46                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-47                        [101, 321, 64]            128
│    └─ConformerBlock: 2-9                         [321, 101, 64]            --
│    │    └─Scale: 3-48                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-49                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-50              [321, 101, 64]            29,376
│    │    └─Scale: 3-51                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-52                        [321, 101, 64]            128
├─TSCB: 1-5                                        [1, 64, 321, 101]         --
│    └─ConformerBlock: 2-10                        [101, 321, 64]            --
│    │    └─Scale: 3-53                            [101, 321, 64]            33,216
│    │    └─PreNorm: 3-54                          [101, 321, 64]            32,976
│    │    └─ConformerConvModule: 3-55              [101, 321, 64]            29,376
│    │    └─Scale: 3-56                            [101, 321, 64]            33,216
│    │    └─LayerNorm: 3-57                        [101, 321, 64]            128
│    └─ConformerBlock: 2-11                        [321, 101, 64]            --
│    │    └─Scale: 3-58                            [321, 101, 64]            33,216
│    │    └─PreNorm: 3-59                          [321, 101, 64]            32,976
│    │    └─ConformerConvModule: 3-60              [321, 101, 64]            29,376
│    │    └─Scale: 3-61                            [321, 101, 64]            33,216
│    │    └─LayerNorm: 3-62                        [321, 101, 64]            128
├─MaskDecoder: 1-6                                 [1, 1, 321, 201]          --
│    └─DilatedDenseNet: 2-12                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-63                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-64                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-65                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-66                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-67                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-68                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-69                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-70                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-71                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-72                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-73                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-74                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-75                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-76                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-77                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-78                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-13                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-79                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-80                           [1, 128, 321, 101]        24,704
│    └─Conv2d: 2-14                                [1, 1, 321, 201]          129
│    └─InstanceNorm2d: 2-15                        [1, 1, 321, 201]          2
│    └─PReLU: 2-16                                 [1, 1, 321, 201]          1
│    └─Conv2d: 2-17                                [1, 1, 321, 201]          2
│    └─PReLU: 2-18                                 [1, 201, 321]             201
├─ComplexDecoder: 1-7                              [1, 2, 321, 201]          --
│    └─DilatedDenseNet: 2-19                       [1, 64, 321, 101]         --
│    │    └─ConstantPad2d: 3-81                    [1, 64, 322, 103]         --
│    │    └─Conv2d: 3-82                           [1, 64, 321, 101]         24,640
│    │    └─InstanceNorm2d: 3-83                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-84                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-85                    [1, 128, 323, 103]        --
│    │    └─Conv2d: 3-86                           [1, 64, 321, 101]         49,216
│    │    └─InstanceNorm2d: 3-87                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-88                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-89                    [1, 192, 325, 103]        --
│    │    └─Conv2d: 3-90                           [1, 64, 321, 101]         73,792
│    │    └─InstanceNorm2d: 3-91                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-92                            [1, 64, 321, 101]         64
│    │    └─ConstantPad2d: 3-93                    [1, 256, 329, 103]        --
│    │    └─Conv2d: 3-94                           [1, 64, 321, 101]         98,368
│    │    └─InstanceNorm2d: 3-95                   [1, 64, 321, 101]         128
│    │    └─PReLU: 3-96                            [1, 64, 321, 101]         64
│    └─SPConvTranspose2d: 2-20                     [1, 64, 321, 202]         --
│    │    └─ConstantPad2d: 3-97                    [1, 64, 321, 103]         --
│    │    └─Conv2d: 3-98                           [1, 128, 321, 101]        24,704
│    └─InstanceNorm2d: 2-21                        [1, 64, 321, 202]         128
│    └─PReLU: 2-22                                 [1, 64, 321, 202]         64
│    └─Conv2d: 2-23                                [1, 2, 321, 201]          258
====================================================================================================
Total params: 1,834,833
Trainable params: 1,834,833
Non-trainable params: 0
Total mult-adds (G): 41.56
====================================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 4856.40
Params size (MB): 7.34
Estimated Total Size (MB): 4864.25
====================================================================================================
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Discriminator                            [1, 1]                    --
├─Sequential: 1-1                        [1, 1]                    --
│    └─Conv2d: 2-1                       [1, 16, 100, 160]         512
│    └─InstanceNorm2d: 2-2               [1, 16, 100, 160]         32
│    └─PReLU: 2-3                        [1, 16, 100, 160]         16
│    └─Conv2d: 2-4                       [1, 32, 50, 80]           8,192
│    └─InstanceNorm2d: 2-5               [1, 32, 50, 80]           64
│    └─PReLU: 2-6                        [1, 32, 50, 80]           32
│    └─Conv2d: 2-7                       [1, 64, 25, 40]           32,768
│    └─InstanceNorm2d: 2-8               [1, 64, 25, 40]           128
│    └─PReLU: 2-9                        [1, 64, 25, 40]           64
│    └─Conv2d: 2-10                      [1, 128, 12, 20]          131,072
│    └─InstanceNorm2d: 2-11              [1, 128, 12, 20]          256
│    └─PReLU: 2-12                       [1, 128, 12, 20]          128
│    └─AdaptiveMaxPool2d: 2-13           [1, 128, 1, 1]            --
│    └─Flatten: 2-14                     [1, 128]                  --
│    └─Linear: 2-15                      [1, 64]                   8,256
│    └─Dropout: 2-16                     [1, 64]                   --
│    └─PReLU: 2-17                       [1, 64]                   64
│    └─Linear: 2-18                      [1, 1]                    65
│    └─LearnableSigmoid: 2-19            [1, 1]                    1
==========================================================================================
Total params: 181,650
Trainable params: 181,650
Non-trainable params: 0
Total mult-adds (M): 19.67
==========================================================================================
Input size (MB): 0.52
Forward/backward pass size (MB): 11.49
Params size (MB): 0.73
Estimated Total Size (MB): 12.73
==========================================================================================
/mnt/iusers01/msc-stu/hum-msc-data-sci-2024-2025/t74061zq/erp/CMGAN_src/data/dataloader.py:52: UserWarning: torchaudio._backend.set_audio_backend has been deprecated. With dispatcher enabled, this function is no-op. You can remove the function call.
  torchaudio.set_audio_backend("sox_io")         # in linux
train.py:226: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  gen_loss_GAN = F.mse_loss(predict_fake_metric.flatten(), one_labels.float())
train.py:242: UserWarning: Using a target size (torch.Size([4])) that is different to the input size (torch.Size([1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  discrim_loss_metric = F.mse_loss(predict_max_metric.flatten(), one_labels) + \
INFO:root:Generator loss: 0.5652170947619847, Discriminator loss: 0.28099875152111053
INFO:root:
=== Epoch 0 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.3315,SSNR: 0.5599,CSIG: 2.3039,CBAK: 2.1566,COVL: 1.8200,STOI: 0.8291,
INFO:root:Generator loss: 0.47025294814790997, Discriminator loss: 0.15855186539036886
INFO:root:
=== Epoch 1 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 1.6748,SSNR: 2.1533,CSIG: 3.0747,CBAK: 2.4486,COVL: 2.3868,STOI: 0.8797,
INFO:root:Generator loss: 0.39533374990735737, Discriminator loss: 0.02138494686888797
INFO:root:
=== Epoch 2 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.1459,SSNR: 3.6715,CSIG: 3.5869,CBAK: 2.7924,COVL: 2.8878,STOI: 0.9053,
INFO:root:Generator loss: 0.3540023650441851, Discriminator loss: 0.12570805847644806
INFO:root:
=== Epoch 3 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.0172,SSNR: 4.2129,CSIG: 3.5256,CBAK: 2.7680,COVL: 2.7934,STOI: 0.9088,
INFO:root:Generator loss: 0.3210376628807613, Discriminator loss: 0.14100636541843414
INFO:root:
=== Epoch 4 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.1654,SSNR: 4.7410,CSIG: 3.6359,CBAK: 2.8833,COVL: 2.9272,STOI: 0.9148,
INFO:root:Generator loss: 0.3205711671284267, Discriminator loss: 0.09802572163087982
INFO:root:
=== Epoch 5 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.2520,SSNR: 5.6238,CSIG: 3.7211,CBAK: 2.9813,COVL: 3.0137,STOI: 0.9200,
INFO:root:Generator loss: 0.2878783515521458, Discriminator loss: 0.06077722393508468
INFO:root:
=== Epoch 6 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3036,SSNR: 5.2499,CSIG: 3.8008,CBAK: 2.9860,COVL: 3.0810,STOI: 0.9225,
INFO:root:Generator loss: 0.28748100783143726, Discriminator loss: 0.16793390150581086
INFO:root:
=== Epoch 7 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.3989,SSNR: 6.1971,CSIG: 3.8718,CBAK: 3.0935,COVL: 3.1687,STOI: 0.9245,
INFO:root:Generator loss: 0.24426927311079843, Discriminator loss: 0.0832661757511752
INFO:root:
=== Epoch 8 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4368,SSNR: 6.8691,CSIG: 3.8834,CBAK: 3.1544,COVL: 3.1930,STOI: 0.9263,
INFO:root:Generator loss: 0.24019389280251094, Discriminator loss: 0.061112698699746816
INFO:root:
=== Epoch 9 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4829,SSNR: 6.9021,CSIG: 3.9184,CBAK: 3.1796,COVL: 3.2381,STOI: 0.9278,
INFO:root:Generator loss: 0.247153673853193, Discriminator loss: 0.033971089869737625
INFO:root:
=== Epoch 10 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.4743,SSNR: 7.1578,CSIG: 3.9078,CBAK: 3.1919,COVL: 3.2254,STOI: 0.9276,
INFO:root:Generator loss: 0.22828311153820582, Discriminator loss: 0.02790378566299166
INFO:root:
=== Epoch 11 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5234,SSNR: 7.5649,CSIG: 3.9125,CBAK: 3.2433,COVL: 3.2543,STOI: 0.9288,
INFO:root:Generator loss: 0.23190654814243317, Discriminator loss: 0.01367266898575638
INFO:root:
=== Epoch 12 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5250,SSNR: 7.8663,CSIG: 3.9369,CBAK: 3.2638,COVL: 3.2696,STOI: 0.9299,
INFO:root:Generator loss: 0.2331741750240326, Discriminator loss: 0.007818862928875856
INFO:root:
=== Epoch 13 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5173,SSNR: 7.6338,CSIG: 3.9489,CBAK: 3.2464,COVL: 3.2752,STOI: 0.9301,
INFO:root:Generator loss: 0.22946341122899735, Discriminator loss: 0.024743227920095836
INFO:root:
=== Epoch 14 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5480,SSNR: 7.8751,CSIG: 3.9598,CBAK: 3.2757,COVL: 3.2961,STOI: 0.9302,
INFO:root:Generator loss: 0.22577076085976192, Discriminator loss: 0.009308073228956866
INFO:root:
=== Epoch 15 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5561,SSNR: 8.1815,CSIG: 3.9613,CBAK: 3.3000,COVL: 3.3007,STOI: 0.9308,
INFO:root:Generator loss: 0.21893433587891714, Discriminator loss: 0.005829362764156291
INFO:root:
=== Epoch 16 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5517,SSNR: 8.2208,CSIG: 3.9532,CBAK: 3.3004,COVL: 3.2935,STOI: 0.9309,
INFO:root:Generator loss: 0.2300686538219452, Discriminator loss: 0.014440216456672974
INFO:root:
=== Epoch 17 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5730,SSNR: 7.4383,CSIG: 3.9519,CBAK: 3.2600,COVL: 3.3023,STOI: 0.9313,
INFO:root:Generator loss: 0.21613305594239915, Discriminator loss: 0.019238828382055675
INFO:root:
=== Epoch 18 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5802,SSNR: 7.8037,CSIG: 3.9587,CBAK: 3.2871,COVL: 3.3104,STOI: 0.9316,
INFO:root:Generator loss: 0.21423143574169703, Discriminator loss: 0.014262964882488762
INFO:root:
=== Epoch 19 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5795,SSNR: 8.5108,CSIG: 3.9666,CBAK: 3.3326,COVL: 3.3157,STOI: 0.9321,
INFO:root:Generator loss: 0.21496961372239248, Discriminator loss: 0.006919912179000676
INFO:root:
=== Epoch 20 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5825,SSNR: 8.6651,CSIG: 3.9710,CBAK: 3.3446,COVL: 3.3203,STOI: 0.9324,
INFO:root:Generator loss: 0.21848486151014054, Discriminator loss: 0.008399389085492917
INFO:root:
=== Epoch 21 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5774,SSNR: 8.0087,CSIG: 3.9677,CBAK: 3.2991,COVL: 3.3152,STOI: 0.9325,
INFO:root:Generator loss: 0.2113525452358382, Discriminator loss: 0.007227245119533369
INFO:root:
=== Epoch 22 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5799,SSNR: 8.4146,CSIG: 3.9727,CBAK: 3.3267,COVL: 3.3195,STOI: 0.9329,
INFO:root:Generator loss: 0.20787931765828813, Discriminator loss: 0.012753132797245468
INFO:root:
=== Epoch 23 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6033,SSNR: 8.7076,CSIG: 3.9814,CBAK: 3.3578,COVL: 3.3350,STOI: 0.9320,
INFO:root:Generator loss: 0.20407573665891374, Discriminator loss: 0.010879455982441348
INFO:root:
=== Epoch 24 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6086,SSNR: 8.8394,CSIG: 3.9902,CBAK: 3.3696,COVL: 3.3442,STOI: 0.9326,
INFO:root:Generator loss: 0.20603684655257634, Discriminator loss: 0.01176764555358594
INFO:root:
=== Epoch 25 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6190,SSNR: 8.7768,CSIG: 3.9902,CBAK: 3.3700,COVL: 3.3491,STOI: 0.9328,
INFO:root:Generator loss: 0.20755505987576076, Discriminator loss: 0.008358860870690219
INFO:root:
=== Epoch 26 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.6151,SSNR: 8.9478,CSIG: 3.9970,CBAK: 3.3798,COVL: 3.3517,STOI: 0.9327,
INFO:root:Generator loss: 0.207137046115739, Discriminator loss: 0.006320599782546716
INFO:root:
=== Epoch 27 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5975,SSNR: 9.0461,CSIG: 3.9926,CBAK: 3.3774,COVL: 3.3420,STOI: 0.9332,
INFO:root:Generator loss: 0.20652989617415837, Discriminator loss: 0.007867422254223908
INFO:root:
=== Epoch 28 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5926,SSNR: 8.6305,CSIG: 3.9848,CBAK: 3.3472,COVL: 3.3351,STOI: 0.9336,
INFO:root:Generator loss: 0.2044971627848489, Discriminator loss: 0.005867198974426303
INFO:root:
=== Epoch 29 evaluation ===
INFO:root:=== Evaluation metrics ===
PESQ: 2.5894,SSNR: 9.1219,CSIG: 3.9873,CBAK: 3.3780,COVL: 3.3359,STOI: 0.9336,
Training finished.
